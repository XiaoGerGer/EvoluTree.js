<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <title>EvoluTree.js</title>

    <script src="dependency-js/jquery-3.5.1.min.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css"
          integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">

    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
            integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js"
            integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
            crossorigin="anonymous"></script>

    <link rel="stylesheet" href="dependency-css/jquery.contextMenu.min.css">
    <link rel="stylesheet" href="dependency-css/bootstrap-colorpicker.min.css">


    <script src="dependency-js/jquery.contextMenu.min.js"></script>
    <script src="dependency-js/bootstrap-colorpicker.min.js"></script>

    <style>
        html, body {
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
        }

        .tree-container {
            height: 100%;
            width: 100%;
        }

        .container-fluid {
            height: 100%;
            width: 100%;
        }

        .page-left {
        }

        .page-right {
            padding: 8px;
            height: 100%;
            overflow: auto;
        }

        .my-row {
            height: 100%;
        }

        .card {
            padding: 8px;
            margin-bottom: 8px;
        }

        .title {
            text-align: center;
            padding: 12px;
        }

        input.slider {
            width: 100%;
        }

        .colorpicker-100 .colorpicker-input-addon i {
            width: 100%;
        }

        .colorpicker-100 .colorpicker-input-addon:before {
            width: 100%;
        }

        .colorpicker {
            z-index: 99999;
        }

    </style>
</head>
<body>
<div class="container-fluid">
    <div class="row my-row">
        <div class="col-8 page-left tree-container"></div>
        <div class="col-4 page-right">
            <h1 class="title">EvoluTree.js</h1>
            <div class="card">
                <h5 class="card-title">Branch scales</h5>
                <div>
                    <input type="radio" id="none" name="branchScales" value="none" checked>
                    <label for="none">None</label>
                    <input type="radio" id="lengthSum" name="branchScales" value="lengthSum">
                    <label for="lengthSum">LengthSum</label>
                </div>
            </div>

            <div class="card">
                <h5 class="card-title">Labels</h5>
                <div>
                    <input type="checkbox" id="showLeafLabel" name="labels" value="showLeafLabel">
                    <label for="showLeafLabel">Show leaf label</label>
                </div>
                <div>
                    <input type="checkbox" id="showNodes" name="labels" value="showNodes">
                    <label for="showNodes">Show Nodes</label>
                </div>
                <div>
                    <input type="checkbox" id="showAlignToTip" name="labels" value="showAlignToTip">
                    <label for="showAlignToTip">show align to tip</label>
                </div>
                <div>
                    <input type="checkbox" id="showRootLine" name="labels" value="showRootLine">
                    <label for="showRootLine">show root line</label>
                </div>
                <div class="row">
                    <div class="col-2"><label for="rootLineLength">Root line length</label></div>
                    <div class="col-10">
                        <input type="range" min="20" max="300" value="20" class="slider" id="rootLineLength">
                    </div>
                </div>
                <div>
                    <input type="checkbox" id="Collapse" name="labels" value="collapse">
                    <label for="Collapse">Collapse</label>
                </div>
            </div>

            <div class="card">
                <h5 class="card-title">Layouts</h5>
                <div>
                    <input type="radio" id="circular" name="layouts" value="layout-circular">
                    <label for="circular">Circular</label>
                    <input type="radio" id="rectangular" name="layouts" value="layout-rectangular">
                    <label for="rectangular">Rectangular</label>
                </div>
            </div>
            <div class="card">
                <h5 class="card-title">Actions</h5>
                <div class="container">
                    <div class="row">
                        <div class="col-2"><label for="rotate">Rotate</label></div>
                        <div class="col-10">
                            <input type="range" min="0" max="360" value="0" class="slider" id="rotate">
                        </div>
                        <div class="col-2"><label for="zoom">Zoom</label></div>
                        <div class="col-10">
                            <input type="range" min="0" max="100" value="0" class="slider" id="zoom">
                        </div>
                        <div class="col-2"><label for="zoomh">Zoom-H</label></div>
                        <div class="col-10">
                            <input type="range" min="0" max="360" value="0" class="slider" id="zoomh">
                        </div>
                        <div class="col-2"><label for="zoomv">Zoom-V</label></div>
                        <div class="col-10">
                            <input type="range" min="0" max="360" value="0" class="slider" id="zoomv">
                        </div>
                        <div class="col-2"><label for="start-degree">Start degree</label></div>
                        <div class="col-10">
                            <input type="range" min="0" max="360" value="0" class="slider" id="start-degree">
                        </div>
                        <div class="col-2"><label for="extent-degree">Extent degree</label></div>
                        <div class="col-10">
                            <input type="range" min="0" max="360" value="0" class="slider" id="extent-degree">
                        </div>
                    </div>
                </div>
            </div>
            <div class="card">
                <h5 class="card-title">Color schema</h5>
                <div>
                    <input type="radio" id="color-schema-none" name="color-schema" value="None">
                    <label for="color-schema-none">None</label>
                </div>
                <div>
                    <input type="radio" id="color-schema-length" name="color-schema" value="lengthSumGradient">
                    <label for="color-schema-length">length Sum By Gradient</label>
                </div>
                <div>
                    <input type="radio" id="color-schema-date" name="color-schema" value="lengthSumThreshold">
                    <label for="color-schema-date">length Sum By Threshold</label>
                </div>
            </div>
            <div class="card annotations">
                <h5 class="card-title">Annotation</h5>
                <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <a class="nav-link active" id="coverage" data-toggle="pill" href="#coverage-content" role="tab"
                           aria-controls="pills-home" aria-selected="true">Coverage</a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link" id="edge" data-toggle="pill" href="#edge-content" role="tab"
                           aria-controls="pills-profile" aria-selected="false">Edge</a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link" id="node" data-toggle="pill" href="#node-content" role="tab"
                           aria-controls="pills-contact" aria-selected="false">Node</a>
                    </li>
                </ul>
                <div class="tab-content" id="pills-tabContent">
                    <div class="tab-pane fade show active" id="coverage-content" role="tabpanel"
                         aria-labelledby="pills-home-tab">
                        <div class="card p-0">
                            <div class="card-header font-weight-bold font-14 p-2">Parameters</div>
                            <div class="card-body p-2">
                                <div class="form-group row row-xs align-items-center mb-1">
                                    <div class="col-md-5">
                                        Shape color:
                                    </div>
                                    <div class="col-md-7">
                                        <div class="shape-color colorpicker-100 colorpicker-element mt-1">
                                            <span class="colorpicker-input-addon"><i></i></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group row row-xs align-items-center mb-1">
                                    <div class="col-md-5">
                                        Anno text:
                                    </div>
                                    <div class="col-md-7">
                                        <input type="text"
                                               class="anno-text form-control form-control-sm">
                                    </div>
                                </div>
                                <div class="form-group row row-xs align-items-center mb-1">
                                    <div class="col-md-5">
                                        Text color:
                                    </div>
                                    <div class="col-md-7">
                                        <div class="text-color colorpicker-100 colorpicker-element mt-1">
                                            <span class="colorpicker-input-addon"><i></i></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group row row-xs align-items-center mb-1">
                                    <div class="col-md-5">
                                        Font style:
                                    </div>
                                    <div class="col-md-7">
                                        <select class="font-style-select custom-select custom-select-sm">
                                            <option value="normal">Normal</option>
                                            <option value="bold">Bold</option>
                                            <option value="italic">Italic</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group row row-xs align-items-center mb-0">
                                    <div class="col-md-5">
                                        Font size:
                                    </div>
                                    <div class="col-md-7">
                                        <input type="number" class="font-size form-control form-control-sm" value="10">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="edge-content" role="tabpanel" aria-labelledby="pills-profile-tab">
                        ...
                    </div>
                    <div class="tab-pane fade" id="node-content" role="tabpanel" aria-labelledby="pills-contact-tab">
                        ...
                    </div>
                </div>
                <div>
                    <button type="button" class="btn btn-secondary mr-3 clear-annotations">Clear annotations</button>
                    <button type="button" class="btn btn-primary annotation-apply">Apply</button>
                </div>
            </div>
        </div>
    </div>

</div>
</body>


<script src="d3-5.16.0/d3.min.js"></script>
<link rel="stylesheet" href="EvoluTree.css">
<script src="EvoluTree.js"></script>

<script>
    $('.shape-color').colorpicker({
        format: 'rgba',
        color: "#4daf4a11",
        showAlphaBar: true,
        useAlpha: true
    })
    $('.text-color').colorpicker({
        format: 'rgba',
        color: "#4daf4a",
        showAlphaBar: true,
        useAlpha: true
    })
</script>

<script>
    const nwk = "(((((((((((((((((T27199905:0,N27199901:0):0.01138620689542192,(((((((T20720000:0.003968279676782308,N20719991:0):0.02819169119458115,(T72200011:0.004803375079803856,N72199903:0):0.02078169546773969):0.009588294103813007,((T13820000:0,N13819981:0):0.02454000402346791,(T90200101:0.01003261820592509,N90199902:0):0.009366526423474558):0.002486401796650966):0.003608278684124558,((T17520011:0.004863164363296617,N17519990:0):0.02628672331630959,((T14220000:0.01315754463342865,N14219990:0.001519794311607769):0.02449019828291938,(T14019990:0.002088622689202597,N14019990:0):0.007953879353380254):0.006120800879169412):0.00481942471568263):0.0017359229333714,((T15820000:0,N15819990:0):0.01461673713319969,((T17020000:0.00362050072666209,N17019990:0):0.01940511449602377,((T23020000:0.006562699546404342,N23019990:0.003247427011686169):0.00488394322968171,(T22619990:0,N22619990:0):0.01135558718170952):0.003333032342735747):0.00157179471462764):0.001658104997854079):0.001761810172585723,(((T11620001:0.00561315030516654,N11619991:0.003402755089605154):0.0257577130981985,(T21219991:0,N21219990:0):0.009744907800835733):0.002579518047089604,((T12920010:0.005593320105206889,N12919991:0):0.01872684105423962,(T11520000:0.004786026883024162,N11519991:0.005765583718663995):0.007465264014310195):0.002965929883419555):0.001562293135319815):0.00105938220833447,(((((((T84200002:0.003345990523889748,N84199903:0.002680850535205825):0.01065618889146285,(T15220010:0.01608491971971904,N15219990:0):0.01957378058014116):0.00191405543755388,(T19620000:0.002405455725653434,N19619990:0):0.01696899072737228):0.005809597312096782,(((N28199901:0.01140445017878757,(((T17319991:0.006344350776006666,N17319990:0.003881614304807318):0.01419708669121811,((T70200202:0,N70199812:0):0.01475779750618346,(T69200009:0,N69199906:0):0.01474471603261629):0.003132562018871871):0,((T19720020:0,N19719990:0):0.008275622280170074,(T11120010:0.009148979641152175,N11119990:0):0.01867834854427819):0.003147486471126614):0):0.003154011239608051,(T45200208:0.01752936738973977,N45200201:0.01259528619045713):0.01164251595415265):0.001443477368485624,(((T24020080:0.00498783299700213,N24020071:0):0.02883967723502238,(T15120020:0.004822646666119094,N15119991:0.001632117708424825):0.009451161081638832):0.006619045612712477,(T36199905:0,N36199901:0):0.006400594973314505):0.002841890047962903):0.002977719159928009):0.00222072529897883,(((((T22320001:0.006495361788551432,N22319990:0):0.01317815291436251,(T14120000:0.002243877297228656,N14119990:0):0.01587130875845443):0.004735006681555895,(T16019991:0,N16019991:0):0.0123200163869548):0.004788728507651177,((((T23620000:0.007650505457257512,N23619991:0):0.01261905699335145,(T19520010:0,N19519990:0):0.0172166946233703):0.00147902917801954,(T13200309:0.0103998130849,N13200010:0):0.008498293184731815):0.004217878717083502,((T22520011:0.006528900349382957,N22519990:0.001535097570603162):0.01314315876153177,(T14200204:0.006794535464214622,N14200012:0.001001870444625211):0.02642389441761086):0.004541025906567333):0.003307383500141235):0.002121575142255389,((((T22220000:0.01482442635332646,N22219991:0):0.01702957945705255,(((T23720060:0.001197389773959699,N23720041:0.00204681570753222):0.01949310510700402,(T16720001:0,N16719991:0):0.01753075218663538):0.006088453827043898,((T21120000:0.003749400710267288,N21119990:0.0004217357442442402):0.01822361322094584,((T12519990:0.005432537277541516,N12519981:0.001635901438333449):0.008362403338384755,(T64199905:0.001717994681106234,N64199904:0):0.02875977622919801):0.004810760531157787):0.002043030103655818):0.00126879098299165):0.003168615608820036,(((((T93200203:0.009674203604406503,N93199906:0):0.01452260411793856,T31200003:0.01339132553747114):0.001687683158487498,((T18819991:0.008171487110636418,N18819990:0.001542877155447621):0.009716771865084455,((T88200112:0,N88199901:0):0.01794106061087249,(T8200310:0,N8199907:0):0.007615432190969022):0.003645360302043741):0.003816829365521996):0,((T21519991:0.001221642297221341,N21519990:0):0.02096922382813168,(T23120000:0.01028772610063305,N23119990:0):0.01211302513853468):0.003144736632287203):0.001144350713432162,((((((((T22720000:0.001606938990565896,N22719990:0):0.0135072438501719,(T66200012:0.01201097532912702,N66199812:0):0.01758562001591768):0.002809861370626026,(T32200007:0.004899653178798034,N32199901:0):0.0303072978438375):0.001456691127862531,((T23320011:0.0064547473447827,N23319990:0.01473463642694258):0.01159534999778127,(T15719991:0,N15719990:0):0.009814649824320539):0.003199078570908704):0.001436512750311689,((((T10920010:0,N10919990:0.003771542793604974):0.007149058894068762,(T97200204:0,N97199901:0.001976292606862045):0.01641811986627809):0.001665945613809078,(T24200309:0,N24200206:0):0.01791325971563653):0.001452225920551971,(T16519991:0.0070108179396303,N16519990:0.001381267691591174):0.01340670625685506):0.002221787175231307):0.001089130217559227,(((((T17920000:0.01141257210013188,N17919990:0):0.021530055154421,(T74200204:0.01194072720280738,(T7199811:0.005075694482849164,N7199611:0.001588182568061762):0.01627743599628613):0.002868014092783148):0.004490992199393568,((T10020000:0.01165498934990082,N10019990:0):0.01426936834212576,(T94200105:0,N94199910:0):0.01673956606945278):0.003536068741389563):0.001504668401914707,((T20620010:0.00323959696546724,N20619990:0):0.01133774167439087,(T25200305:0.0082709543780875,N25200207:0.005597433073758736):0.02560557674387131):0.007192209102197011):0.0005043403493087675,N74199812:0.006703411325933771):0):0,((((T13019990:0,N13019981:0):0.01142714790082963,((T16420011:0,N16419990:0):0.01461757691135204,((T17620000:0.007253048080569019,N17619981:0):0.01324625964712978,(T29200003:0.02717753573160469,N29199901:0.003243201438090061):0.003231362888740946):0.003447880246200589):0):0.00341463301296934,((T18319990:0,N18319990:0):0.02938758726534801,(((T24220020:0.00199411647592395,N24220000:0.00112202845521218):0.0253382036430624,((T85199908:0.0072119265028963,N85199811:0.002473616857759484):0.0424610327349474,T22199809:0.03497383456553265):0.007872328246191563):0.004085321170282965,T17199703:0.01869192584907714):0.003976825915096545):0.002855239740341604):0.001008515849889382,((((T10720000:0.003227618742850984,N10719990:0):0.02207345638497446,T1199908:0.03183196539978755):0.004141039359469669,(T20200108:0,N20200107:0):0.01637110741350244):0.002105305460913564,((T62200201:0.01511677191908654,N62200101:0.001205151929377256):0.02198081451834616,N2199809:0.01533384119334034):0.005303802800317422):0.002025611866809348):0.00105419228419088):0.001055075128100311,((((T14920010:0.002151328918528997,N14919990:0):0.01866346350488356,(T11819990:0.003230563730784564,N11819990:0):0.02235467379529004):0.00462268089066904,((((T23520000:0.008725858650597874,N23519990:0):0.02511527838873102,(T10219990:0,N10219981:0):0.02052135077129327):0.002495959945451691,((T14819991:0.002347351121746907,N14819990:0.003030818208952487):0.02006529821295552,(T6200007:0,N6199906:0):0.01461120429789579):0.003399960894844004):0.002260179052501479,((T13519991:0.003213705282202493,N13519990:0):0.009138919932399344,(T67199909:0,N67199906:0):0.01642874590217443):0.004490976650511992):0):0.001255950277182415,(((T21920000:0.002077503623256982,N21919990:0):0.01499932618538165,(T18520000:0.0105756779613584,N18519990:0):0.02380659627414928):0.004215992470986508,(T14620001:0.006286250814067891,N14619991:0):0.00836634788767401):0.001433687532001357):0.002165162724481749):0.0006622949509149424):0.0007685957182302498):0,((T16219990:0.001166307470703672,N16219990:0):0.01158015396473006,(T16620000:0.008288852164344504,N16619990:0.002034469057633359):0.01242403652286499):0.001040591834944086):0.001019289187582037):0.001014137397049835):0,(((((((T82200102:0.005243643231075758,N82199909:0):0.01985190462790852,((T12719990:0.001722702684307758,N12719990:0):0.02293328699594886,(T76200005:0.006900991175508428,N76199904:0):0.01124106965636261):0.001039762439799288):0.001290293513946146,((T22020000:0,N22019990:0):0.01281680693751211,((T11920000:0,N11919991:0):0.01315167482009004,(T11420000:0,N11419990:0):0.004932254342524447):0.001560858088835868):0):0.001988997381142687,((T23420001:0.004462468854842863,N23419990:0):0.01359517892780569,(T13720000:0.003236337881233812,N13719991:0):0.02161153165440148):0.007049834432141373):0.001046457830237344,((((T78199912:0.003912990885387897,N78199911:0):0.009078721019786578,(T75200101:0,N75199811:0):0.01567628034402805):0.01081011373594941,(((T13620010:0,N13619991:0):0.02162855025025232,(T16200304:0.00264102131587983,N16200103:0.002271128592148868):0.01231782658482129):0.007941706447211936,(T18200309:0,N18200108:0.001126964830894088):0.01555228364009211):0.001601728282527383):0,((T26200211:0.007638482491427252,N26200207:0):0.01663748871906848,((T21420000:0.001270631253314583,N21419990:0):0.01316700945600009,(((T13219990:0.003164928483423403,N13219990:0):0.01425199677802359,N31199901:0.02154250079771052):0.001688409559286078,((T89199904:0,N89199902:0):0.02759372238251245,(T44200204:0.006183684257015383,N44200201:0.003359134001756103):0.02738634477238961):0.005679554173733688):0.003387803272372283):0.001562596542616162):0.001596325959660594):0.001476875500578399):0.001041506483468608,(((((((((T22820001:0.001741290588790207,N22819990:0):0.02159937692167132,(T11200103:0.003377261477184302,N11199911:0.001084548960986736):0.01028655537957128):0.003267256211205573,(T10320000:0.00955588577197615,N10319990:0):0.02991815174108221):0.001191425379681128,((T87200011:0.02458384963302768,N87199903:0.001413539029008268):0.008938325929487938,(T22420000:0.005154856273466776,N22419990:0):0.0157122412995783):0.0009756391222859835):0.001766196075364526,(T15319991:0,N15319990:0.001621173027594102):0.0048360941340705):0,((T16119990:0.001202764355142867,N16119990:0):0.02085384098424043,((T15520000:0.01285816393631002,N15519981:0.001493298078919881):0.01833502747819225,((T20520000:0.002293038009870172,N20519990:0.002237442896162959):0.01505523336505575,((T20419990:0.005849437469014633,N20419990:0):0.01370038899888026,(T15019990:0,N15019990:0):0.003262932162036154):0):0.001606126694809686):0):0.00146629875387522):0.002876394389297475,((T19219990:0.001789942425731976,N19219990:0):0.01462381572950972,(T12020020:0.009073326909212004,N12019991:0):0.01378164802833682):0.004741968647147957):0,(((T63200201:0.007376682404645733,N63200101:0.003635214097718627):0.02647478942497863,((T15920000:0.008753385221217012,N15919990:0):0.01352916435773641,(T19120010:0,N19119990:0):0.01699395400949969):0.003100133987286357):0.004231820075371934,(T17420020:0.002449911623006233,N17419990:0):0.01215760651726252):0):0.002042924642784025,((((T10420000:0.001304207517241176,N10419990:0):0.02781355568859463,(T14720001:0.001624852636530002,N14719991:0):0.02183238003242292):0.005661920441631335,((T81200002:0.001155478329944779,N81199910:0):0.01857670036880732,(T12200101:0,N12200008:0):0.02547622347194146):0.01055825079679811):0.002144069540205392,(T21019991:0.005864094682953118,N21019990:0):0.01035706389815051):0.002648889481350935):0):0.001040248029045173,((((T19020020:0.001627189683674996,N19019990:0.005504263738879666):0.008916226179033067,((T18720000:0.004563007836816283,N18719990:0):0.006839299226695019,((T14320001:0.002010391837363181,N14319990:0):0.01447312369223393,(T11319991:0.003772433012381132,N11319990:0):0.01911342964010822):0.001561301504805701):0):0.002743218854384755,((T99200101:0.005063750415566665,N99199903:0):0.009268253185505618,(T71200006:0.01203043256305302,N71199901:0):0.004980515987089595):0.004140037132269295):0,(((T19420000:0,N19419981:0):0.01458845275329764,(T30199909:0.00491537921234951,N30199901:0.001620997804412069):0.008086336520306842):0.0006684417497470948,((T15419990:0,N15419981:0):0.01772896046361707,(T86200009:0.001151568688107374,N86199901:0.002253496011364783):0.02036574849696872):0.006460181018583656):0.002776051282193876):0):0.001039593057599732):0.001036290275395401,((N22199107:0.0150594445006307,(((T22920001:0,N22919990:0):0.01800615944753592,(T11220000:0.003694188341321368,N11219990:0):0.03240979122860609):0.003610802803488218,(((((N19819990:0.01648615436805628,(T12619990:0,N12619990:0):0.01256331902999928):0.003880315301332986,(T10200305:0.0102576784029276,N10199911:0.002180311905431939):0.009370676134944616):0.002066509771159639,((T19920000:0.008929321265226891,N19919991:0.003124930824081921):0.02252510601273196,(T98199910:0.006650261740915545,N98199901:0.001122480292562983):0.02051843286857218):0.003789804766284507):0.001129290617422858,(N17199606:0.002963089251499418,((((((((((T23220001:0,N23219990:0.001622762107148526):0.01907355363881697,(T15619991:0,N15619990:0):0.01514499962812647):0.003349882266840647,(T17720000:0,N17719990:0):0.01693374603463501):0.005751556310433756,(((T21720000:0.00224934530195341,N21719990:0):0.012111268603245,(T21620020:0.007173339317209659,N21619990:0.002468438621264191):0.01690400913750864):0.0036283152481359,(T33200009:0.01159152937860665,N33199901:0.001575902531374195):0.007675659176678023):0.00423035828838914):0,(((T18420000:0,N18419990:0):0.008083039618346735,((T83200010:0,N83199909:0):0.01062423220334011,(T79200004:0.01040545860216092,N79199912:0.00777761493005692):0.006616573580254857):0.01386400951888534):0,(T12120000:0.01312274961094829,N12119990:0):0.01411714881406484):0.004470530154625396):0.002090814668380807,((T17120000:0.01240001733568181,N17119990:0.003396024475659429):0.005346981382423398,((T12320000:0.01211829205659394,N12319990:0.00459208041560504):0.01522730666709893,(T95200001:0.01562897868307272,N95199908:0):0.01555727967986558):0.003634296760518691):0.002121634915128622):0.001062911283213303,((T37199910:0.001627017804623323,N37199901:0.001612753891805057):0.006552286876884289,(((T20920000:0,N20919990:0):0.007216869836295239,(T18220000:0,N18219990:0):0.009758719903206075):0.004323590811309164,(T35200006:0.01829850406571055,((N35199901:0,N34199901:0.003234990584190891):0,T34199911:0.003270878502833841):0.004119894425484423):0.004032895322055029):0.001414079428906241):0.002855106443076798):0.001039938162628152,(T18120000:0,N18119990:0):0.004906025868668588):0,((T13419991:0.003219097522613962,N13419990:0):0.007300878220383196,(T13119990:0.0018967859189878,N13119990:0):0.009452917611885096):0.007285401429002111):0,((T20319990:0.001840692337998029,N20319990:0):0.01125655653796251,(T21199809:0.02350766702312165,N21199201:0.001322774188203956):0.01882003461395946):0.004581159200305255):0):0.000006187697318095638):0.002123068792622071,(((T20120010:0.008272172063921385,N20119991:0.001514171528783469):0.0164560631885308,N1199101:0.006973714174390672):0.002303678804379958,((T21319991:0.001846540315155742,N21319990:0.003328472851177257):0.01671621760541486,T28200101:0.02297866871954074):0.004276926118838565):0.001511016822398803):0.0009712731318673794):0):0,(((((T16920011:0.00841079151577326,N16919990:0.001835065836181027):0.01902891630412762,((((T20219990:0,N20219981:0):0.02273754246245133,(T12219990:0.01256805514445486,N12219990:0.0009770570911414754):0.02212030070300188):0.005484298038251241,((T12419991:0,N12419991:0):0.02433590723368837,(T11020000:0,N11019990:0.002656001588941253):0.01884219741840893):0.00429000456358014):0.003476234564183219,((T13920000:0.005924292668696391,N13919981:0.001584336281338829):0.025755742682773,(T43200209:0.006972793051199975,N43200201:0.009183854617632835):0.02376691523924416):0.0084048572234593):0.001286925772646752):0.002493716346841431,((T17820020:0.01137474993913851,N17819990:0):0.02597083382714228,(T12819991:0.00921509783505666,N12819990:0):0.01040411393189935):0.003541618428037471):0.001125700839333055,(((((T18919990:0.001597087091556467,N18919981:0.003232807786025179):0.01482557016022515,(T10120000:0,N10119990:0):0.02364849780893242):0.007033595008115141,(T20020000:0,N20019991:0):0.01105999449451139):0.003304270397026134,(T22120000:0.002185166588987967,N22119990:0):0.02200033777960502):0.005140722405664402,(((T10620010:0,N10619990:0):0.01949998020925844,(T96199911:0,N96199908:0):0.01300276051578456):0,((T68199912:0.002003053796660339,N68199905:0):0.02240248318084861,(T15200201:0.002374826927860651,N15200101:0):0.02172979638620977):0.004394020615838399):0.001415529916500173):0):0.001165180451742041,((((T16820010:0.008674833484536982,N16819990:0):0.02517570262342435,(T11720000:0,N11719991:0):0.02140714510288473):0.005186575202084516,(T92200003:0.001631923524254833,N92199904:0):0.02065205879925294):0.006045124949155488,(T19320000:0.003222706357503945,N19319990:0):0.02883545076714032):0.004137149998998134):0.001185341124573675):0):0.001037789280139744):0.001080876301473554):0.00001520600434743215,((T9200006:0.003529225831279144,N9199909:0):0.01778770160648235,(T23200207:0,N23200204:0):0.01363938353627047):0.001107080737946442):0,((((T13320000:0.0225359699435503,N13319990:0.004659085655024566):0.01105074494871993,(T5200107:0.001432594694482698,N5199906:0):0.02199377345153633):0.003022127711755209,(((T16320000:0,N16319990:0.003171443039071567):0.02207034793980907,(T14520001:0,N14519991:0):0.01463238218258723):0.002190030254469735,((T91199912:0.003504749190971844,N91199903:0):0.01769504197229954,(T4200608:0.00940360726951481,N4199904:0.0009482024540384741):0.02265063558772306):0.005016900352145219):0.001129022944578108):0.0009157857999393113,((T18620020:0,N18619991:0):0.01468237951739062,(T10819990:0.002751644183116745,N10819981:0):0.01673469177947382):0):0.002232774112040849):0,(T80200007:0,N80199904:0):0.009756287951054326):0.0021406205986139,((T73200108:0,N73199904:0):0.01796026271606089,(((T65200101:0.004180671023536935,N65199902:0):0.01691305889225026,((T19820000:0,(T18020000:0.00210584166201733,N18019990:0):0.01313284947437502):0.0108847637401159,(T17220001:0,N17219990:0):0.01785234871081191):0):0.001612346025238759,(T3200011:0.02086631787547204,N3199901:0.001391396880562797):0.008130682408574466):0.001803392102412584):0.00188228923447055):0.004531932757914264,(T14420000:0,N14419990:0):0.01455623989058554):0.007713180802357153,(T10520000:0,N10519990:0):0.02110795936248715):0.008892237251847226,(((T40199905:0.01493038435227479,N40199903:0.003370106113513746):0.007538613824540713,(T39199907:0.02878871730829442,N39199905:0.01335108975911532):0.008575521017525001):0.002808711897177399,(T38199907:0.008201894162501697,N38199905:0.01342871471145524):0.01024152024941548):0.01878004468463177):0.02484898701852344,(T20820000:0.003170628988853852,N20819990:0.01099089244145558):0.05585452381479408):0.01125420196862354,((T23820090:0.007987161906356555,N23820050:0.006148664406339269):0.01780318484071531,(T77200005:0.003124312396251959,N77199906:0.001459974842618448):0.03198220229268158):0.02584366496709548):0.02597453146759539,T24120081:0.03864241748642894):0.03300294993527012,((T41200107:0.01444818262066288,N41200002:0.003011187586153677):0.02230186869440706,T56200502:0.0335492345123654):0.003174569278850305):0,(T49200502:0,N49200412:0):0.005639920748681588):0.001336776845097499,(T51200502:0,N51200412:0.004153013983007625):0.006706531896977938):0.00205850601190615,((((((T47200502:0.001436153471593556,N47200412:0):0.009679296939631285,((T59200502:0,N59200412:0):0.005540917272322182,(T60200502:0.002885975912464055,N60200412:0):0.006929166077916798):0.001348632201175397):0,((T54200502:0,N54200412:0):0.0152687565969137,(T48200502:0.001627306092507258,N48200412:0.002787914864729637):0.009520192081233947):0.001382070341903565):0.001322034136385744,(((T23920070:0.01395724638660448,N23920060:0.001080318657582804):0.01970848047108213,(T50200502:0,N50200412:0):0.009661260525299144):0.00544024837940175,(T52200502:0,N52200412:0):0.01540546619476677):0.001248385941994731):0.002682413698015078,((((T55200502:0,N55200412:0):0.01682911305926349,(T46200502:0,N46200412:0.001481041368767828):0.01780369748104421):0.001444033407252808,(T61200502:0,N61200412:0.001521800610569573):0.01218535524666058):0.001447163692755628,(T58200502:0,N58200412:0):0.01818019963639847):0.00138263780666507):0.001331405324465266,((T57200502:0.001435097348068635,N57200412:0.001373590247582916):0.01789568017940548,N56200412:0.008850306253259565):0.002422790439468266):0.0007742819013790788):0.02843530646837358,T53200502:0.003017659074615583,N53200412:0.002874117492852019)"
    const et = d3.evolutree({
        container: ".tree-container",
        data: {
            nwk: {
                value: nwk
            },
            branchScales: [
                {
                    name: "lengthSum",
                    type: "number",
                    field: (d) => d.data.lengthSum
                }
            ],
            colorSchemas: [
                {
                    name: "lengthSumGradient",
                    scaleName: "lengthSum",
                    colorPlan: "Rainbow",
                }, {
                    name: "lengthSumThreshold",
                    setColor: d3.evolutree.colorByLengthSumThreshold(0.1),
                }
            ],
        },
        layout: {
            onZoom: function (num) {
                $("#zoom").val(num)
            },
            onNodeMouseover: function (node) {
                console.log("onNodeMouseover", node)
            },
            onNodeMouseout: function (node) {
                console.log("onNodeMouseout", node)
            },
            onNodeLeftClick: function (node) {
                console.log("onNodeLeftClick", node)
            },
            onNodeRightClick: function (node) {
                console.log("onNodeRightClick", node)
            },
            onLineMouseover: function (relation) {
                console.log("onLineMouseover", relation)
            },
            onLineMouseout: function (relation) {
                console.log("onLineMouseout", relation)
            },
            onLineLeftClick: function (relation) {
                console.log("onLineLeftClick", relation)
            },
            onLineRightClick: function (relation) {
                console.log("onLineRightClick", relation)
            },
            onLabelMouseover: function (node) {
                console.log("onLabelMouseover", node)
            },
            onLabelMouseout: function (node) {
                console.log("onLabelMouseout", node)
            }
        }
    })

    // ----------------------------------------------------------------------------------------------------------------

    window.onresize = function () {
        et.resize()
    }

    $("input[type=radio][name=branchScales]").on("change", function () {
        et.switchScaleTo($(this).val())
        et.refresh()
    })

    $("input[type=checkbox]").on("change", function () {
        switch ($(this).val()) {
            case "showLeafLabel":
                et.showLeafLabel(this.checked)
                break
            case "showNodes":
                et.showNodes(this.checked)
                break
            case "showAlignToTip":
                et.showAlignToTip(this.checked)
                break
            case "showRootLine":
                et.showRootLine(this.checked)
                break
            case "collapse":
                et.collapse(this.checked, et.getSelected())
                break
            default:
                break
        }
    })

    $("input.slider").on("change", function () {
        switch ($(this).attr("id")) {
            case "rootLineLength":
                et.setRootLineLength(+$(this).val())
                break
        }
    })

    $("input[type=radio][name=layouts]").on("change", function () {
        et.switchLayoutTo($(this).val())
    })

    $("#rotate").on("input propertychange", function () {
        et.setRotate(+$(this).val())
    })

    $("#start-degree").on("change", function () {
        et.setStartDegree(+$(this).val())
    })

    $("#extent-degree").on("change", function () {
        et.setExtentDegree(+$(this).val())
    })

    $("input[type=radio][name=color-schema]").on("change", function () {
        et.switchColorSchemaTo($(this).val())
    })

    $(".clear-annotations").on("click", function () {
        et.clearAnnotations()
    })

    $(".annotation-apply").on("click", function () {
        let node = et.getSelected()
        if (node.length === 0){
            alert("Please select a node before")
            return
        }
        node = node[0]
        const annoType = $('.annotations li a.active').attr("id")
        const args = {}
        switch (annoType) {
            case "coverage":
                const p = $("#coverage-content")
                args.shapeColor = p.find(".shape-color").colorpicker("getValue")
                args.annoText = p.find(".anno-text").val()
                args.textColor = p.find(".text-color").colorpicker("getValue")
                args.fontStyle = p.find(".font-style-select option:selected").val()
                args.fontSize = +p.find(".font-size").val()
                break
            default:
                break
        }
        et.markAnnotation(node, annoType, args)
    })

</script>
</html>